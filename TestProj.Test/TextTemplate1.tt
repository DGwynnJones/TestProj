<#@ template debug="false" hostspecific="true" language="C#" #>
<#@ assembly name="System.Core" #>
<#@ import namespace="System.IO" #>
<#@ import namespace="System.Linq" #>
<#@ import namespace="System.Text" #>
<#@ assembly name="$(SolutionDir)TestProj.Test\bin\$(ConfigurationName)\TestProj.Test.dll" #>
<#@ import namespace="System.Collections.Generic" #>
<#@ output extension=".cmd" #>
@ECHO OFF
@ECHO OFF
CLS

<#
var rgPath = new FileInfo(this.Host.ResolvePath("")).Directory;
var rgExe = rgPath.GetFiles("ReportGenerator.exe", SearchOption.AllDirectories);
var ocExe = rgPath.GetFiles("OpenCover.Console.exe", SearchOption.AllDirectories);
#>

ECHO RG: <#= rgPath  #>
ECHO RG: <#= rgExe.Length  #>
ECHO RG: <#= rgExe[0].FullName  #>
ECHO Script generated at: <#= DateTime.Now.ToString() #>

"<#= ocExe[0].FullName  #>" -filter:"+[TestProj*]* -[TestProj.Test]*" -target:"..\..\..\packages\NUnit.ConsoleRunner.3.9.0\tools\nunit3-console.exe"  -targetargs:"TestProj.Test.dll " -output:"_CodeCoverageResult.xml" -register:user

"<#= rgExe[0].FullName  #>" "-reports:_CodeCoverageResult.xml" "-targetdir:Report"

Report\index.htm

